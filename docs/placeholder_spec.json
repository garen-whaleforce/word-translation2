{
  "$schema": "placeholder_spec_v1",
  "description": "CNS Report Template Placeholder Specification",
  "placeholders": {
    "cover_page": {
      "bsmi_designated_report_no": {
        "description": "標準檢驗局試驗報告指定編號",
        "example": "SL2INT0157250509",
        "source": "job_input",
        "required": true,
        "table": 0,
        "row": 2,
        "col": 2
      },
      "report_no": {
        "description": "報告編號",
        "example": "AST-B-25120522-000",
        "source": "job_input",
        "required": true,
        "table": 0,
        "row": 3,
        "col": 2
      },
      "applicant_name": {
        "description": "申請者名稱",
        "example": "鼎福科技有限公司",
        "source": "job_input",
        "required": true,
        "table": 0,
        "row": 4,
        "col": 2
      },
      "applicant_address": {
        "description": "申請者地址",
        "example": "新北市中和區民治街19巷8號",
        "source": "job_input",
        "required": true,
        "table": 0,
        "row": 5,
        "col": 2
      },
      "factory_name": {
        "description": "生產廠場",
        "default_value": "詳見報告第4頁",
        "source": "fixed",
        "table": 0,
        "row": 6,
        "col": 2
      },
      "factory_address": {
        "description": "生產廠場地址",
        "default_value": "詳見報告第4頁",
        "source": "fixed",
        "table": 0,
        "row": 7,
        "col": 2
      },
      "cns_standard": {
        "description": "試驗標準(規範)",
        "example": "CNS 15598-1 (109年版)",
        "source": "job_input",
        "default_value": "CNS 15598-1 (109年版)",
        "table": 0,
        "row": 8,
        "col": 2
      },
      "test_type": {
        "description": "試驗方式",
        "example": "型式試驗",
        "source": "job_input",
        "default_value": "型式試驗",
        "table": 0,
        "row": 9,
        "col": 2
      },
      "product_name_zh": {
        "description": "品名（中文）",
        "example": "交流電源供應器",
        "source": "from_cb_pdf",
        "extraction_rule": {
          "cb_field": "product_name_en",
          "transform": "translate_to_zh",
          "mapping": {
            "AC POWER SUPPLY": "交流電源供應器",
            "AC/DC POWER SUPPLY": "交流/直流電源供應器",
            "SWITCHING POWER SUPPLY": "交換式電源供應器",
            "ADAPTER": "電源適配器",
            "POWER ADAPTER": "電源適配器"
          }
        },
        "table": 0,
        "row": 10,
        "col": 2
      },
      "main_model": {
        "description": "主型號",
        "example": "MC-601",
        "source": "from_cb_pdf",
        "extraction_rule": {
          "cb_field": "model_main",
          "regex": "Model/Type Ref\\.?:?\\s*([A-Za-z0-9-]+)"
        },
        "table": 0,
        "row": 11,
        "col": 2
      },
      "series_model": {
        "description": "系列型號",
        "example": "A1231-200300C-US1",
        "source": "from_cb_pdf",
        "extraction_rule": {
          "cb_field": "series_models",
          "note": "取第一個系列型號，或用逗號連接多個"
        },
        "table": 0,
        "row": 12,
        "col": 2
      },
      "trademark": {
        "description": "廠牌/商標",
        "example": "",
        "source": "from_cb_pdf",
        "extraction_rule": {
          "cb_field": "trademark",
          "note": "通常為空或由 CB 報告擷取"
        },
        "table": 0,
        "row": 13,
        "col": 2
      },
      "rated_input": {
        "description": "額定輸入",
        "example": "100-240 V～, 50/60 Hz, 1.7 A",
        "source": "from_cb_pdf",
        "extraction_rule": {
          "cb_field": "ratings_input",
          "regex": "(?:Input|INPUT):?\\s*([\\d\\-]+\\s*V[^,]*,\\s*[\\d/]+\\s*Hz[^,]*,\\s*[\\d.]+\\s*A)"
        },
        "table": 0,
        "row": 14,
        "col": 2,
        "note": "此欄位需要「輸入:」前綴，並與輸出合併顯示"
      },
      "rated_output": {
        "description": "額定輸出",
        "example": "5.0 V  3.0 A 15.0 W or 9.0 V  3.0 A 27.0 W",
        "source": "from_cb_pdf",
        "extraction_rule": {
          "cb_field": "ratings_output"
        },
        "table": 0,
        "row": 14,
        "col": 2,
        "note": "與 rated_input 合併在同一儲存格"
      },
      "not_applicable_items": {
        "description": "測試項目不適用",
        "example": "不適用",
        "source": "job_input",
        "default_value": "不適用",
        "table": 0,
        "row": 15,
        "col": 2
      },
      "sample_conforms": {
        "description": "測試樣品符合要求",
        "example": "符合",
        "source": "derived",
        "derivation_rule": "if overall_result == '符合' then '符合' else '不適用'",
        "table": 0,
        "row": 16,
        "col": 2
      },
      "sample_not_conforms": {
        "description": "測試樣品不符合要求",
        "example": "不符合",
        "source": "derived",
        "derivation_rule": "if overall_result == '不符合' then '不符合' else '不適用'",
        "table": 0,
        "row": 17,
        "col": 2
      },
      "sample_received_date": {
        "description": "試驗件收件日",
        "example": "114 年 12 月05 日",
        "source": "job_input",
        "format": "民國年 年 MM 月DD 日",
        "table": 0,
        "row": 18,
        "col": 2
      },
      "test_date": {
        "description": "執行測試日",
        "example": "114 年 07 月28 日",
        "source": "job_input",
        "format": "民國年 年 MM 月DD 日",
        "table": 0,
        "row": 19,
        "col": 2
      },
      "issue_date": {
        "description": "報告發行日",
        "example": "114 年 07 月29 日",
        "source": "job_input",
        "format": "民國年 年 MM 月DD 日",
        "table": 0,
        "row": 20,
        "col": 2
      },
      "lab_name": {
        "description": "測試單位",
        "example": "安捷檢測有限公司",
        "source": "job_input",
        "default_value": "安捷檢測有限公司",
        "table": 0,
        "row": 21,
        "col": 2
      },
      "lab_address": {
        "description": "測試單位地址",
        "example": "新北市新店區寶興路45巷8弄16號4樓",
        "source": "job_input",
        "default_value": "新北市新店區寶興路45巷8弄16號4樓",
        "table": 0,
        "row": 22,
        "col": 2
      },
      "overall_result": {
        "description": "試驗結果",
        "example": "符合",
        "source": "job_input",
        "allowed_values": ["符合", "不符合"],
        "table": 0,
        "row": 23,
        "col": 2
      },
      "report_author": {
        "description": "報告製作者",
        "example": "",
        "source": "job_input",
        "table": 0,
        "row": 25,
        "col": 1
      },
      "report_signer": {
        "description": "報告簽署人",
        "example": "",
        "source": "job_input",
        "table": 0,
        "row": 25,
        "col": 4
      }
    },
    "revision_history": {
      "rev1_item": {
        "description": "修訂項次",
        "example": "01",
        "source": "job_input",
        "default_value": "01",
        "table": 2,
        "row": 2,
        "col": 0
      },
      "rev1_date": {
        "description": "修訂發行日期",
        "example": "114.07.29",
        "source": "job_input",
        "format": "民國年.MM.DD",
        "table": 2,
        "row": 2,
        "col": 1
      },
      "rev1_report_no": {
        "description": "修訂報告編號",
        "example": "AST-B-25120522-000",
        "source": "job_input",
        "note": "通常與封面報告編號相同",
        "table": 2,
        "row": 2,
        "col": 2
      },
      "rev1_desc": {
        "description": "修訂內容說明",
        "example": "主報告",
        "source": "job_input",
        "default_value": "主報告",
        "table": 2,
        "row": 2,
        "col": 3
      }
    },
    "test_particulars": {
      "supply_connection_type": {
        "description": "電源連接方式",
        "example": "A 型插接式設備",
        "source": "from_cb_pdf",
        "extraction_rule": {
          "cb_field": "test_item_particulars.supply_connection",
          "mapping": {
            "Direct plug-in equipment": "直插式設備",
            "A type plug connected": "A 型插接式設備",
            "Permanently connected": "永久連接式",
            "Detachable power supply cord": "分離式電源線"
          }
        },
        "table": 3,
        "row": 5,
        "col": 1
      },
      "protective_device_rated_current": {
        "description": "考慮保護裝置的額定電流",
        "example": "20 A建築",
        "source": "from_cb_pdf",
        "extraction_rule": {
          "cb_field": "protective_device_rating",
          "regex": "([\\d.]+)\\s*A"
        },
        "table": 3,
        "row": 6,
        "col": 1
      },
      "equipment_mobility": {
        "description": "設備移動性",
        "example": "直插式設備",
        "source": "from_cb_pdf",
        "extraction_rule": {
          "cb_field": "test_item_particulars.mobility",
          "mapping": {
            "plug-in equipment": "直插式設備",
            "movable equipment": "移動式設備",
            "stationary equipment": "放置式設備",
            "hand-held equipment": "手持式設備"
          }
        },
        "table": 3,
        "row": 7,
        "col": 1
      },
      "ovc": {
        "description": "過壓類別",
        "example": "OVC II",
        "source": "from_cb_pdf",
        "extraction_rule": {
          "cb_field": "test_item_particulars.ovc",
          "regex": "OVC\\s*(I{1,3}V?|IV)"
        },
        "table": 3,
        "row": 8,
        "col": 1
      },
      "protection_class": {
        "description": "防電擊保護等級",
        "example": "Class II",
        "source": "from_cb_pdf",
        "extraction_rule": {
          "cb_field": "test_item_particulars.supply_connection",
          "mapping": {
            "Class I": "Class I",
            "Class II": "Class II",
            "Class III": "Class III"
          }
        },
        "table": 3,
        "row": 9,
        "col": 1
      },
      "special_installation": {
        "description": "特殊安裝位置",
        "example": "無特殊安裝",
        "source": "from_cb_pdf",
        "default_value": "無特殊安裝",
        "table": 3,
        "row": 10,
        "col": 1
      },
      "pollution_degree": {
        "description": "污染等級",
        "example": "PD 2",
        "source": "from_cb_pdf",
        "extraction_rule": {
          "cb_field": "test_item_particulars.pollution_degree",
          "regex": "PD\\s*([123])|Pollution\\s*degree\\s*([123])"
        },
        "table": 3,
        "row": 11,
        "col": 1
      },
      "tma_c": {
        "description": "製造商宣告Tma（最高環境溫度）",
        "example": "45 °C",
        "source": "from_cb_pdf",
        "extraction_rule": {
          "cb_field": "test_item_particulars.tma",
          "regex": "(\\d+)\\s*°?C"
        },
        "table": 3,
        "row": 12,
        "col": 1
      },
      "ip_rating": {
        "description": "IP等級",
        "example": "IPX0",
        "source": "from_cb_pdf",
        "extraction_rule": {
          "cb_field": "test_item_particulars.ip_code",
          "regex": "IP[X\\d]+\\d?"
        },
        "table": 3,
        "row": 13,
        "col": 1
      },
      "equipment_altitude": {
        "description": "設備適用的海拔高度",
        "example": "2000 m 或更低",
        "source": "from_cb_pdf",
        "extraction_rule": {
          "cb_field": "test_item_particulars.altitude_limit_m",
          "transform": "if value <= 2000 then '2000 m 或更低' elif value <= 5000 then '5000 m' else '{value} m'"
        },
        "table": 3,
        "row": 15,
        "col": 1
      },
      "lab_altitude": {
        "description": "測試實驗室海拔高度",
        "example": "2000 m 或更低",
        "source": "job_input",
        "default_value": "2000 m 或更低",
        "table": 3,
        "row": 16,
        "col": 1
      },
      "eut_mass_kg": {
        "description": "設備質量",
        "example": "0.072 kg",
        "source": "from_cb_pdf",
        "extraction_rule": {
          "cb_field": "equipment_mass",
          "regex": "([\\d.]+)\\s*kg"
        },
        "table": 3,
        "row": 17,
        "col": 1
      },
      "cb_report_reference": {
        "description": "CB報告參考（備註欄）",
        "example": "此份報告是依據 UL Solutions (Demko) (CB004)所發行之CB證書，其報告號碼為2025112058855971-00",
        "source": "from_cb_pdf",
        "extraction_rule": {
          "cb_field": "basic_info.cb_report_no",
          "template": "此份報告是依據 {ncb_name} ({ncb_code})所發行之CB證書，其報告號碼為{cb_report_no}"
        },
        "table": 3,
        "row": 18,
        "col": 0,
        "note": "備註欄，目前為固定文字"
      }
    }
  },
  "source_types": {
    "job_input": "需由使用者/專案輸入的欄位",
    "from_cb_pdf": "可從 CB PDF 報告自動擷取的欄位",
    "fixed": "固定值，不需要 placeholder",
    "derived": "由其他欄位推導計算"
  }
}
